

<script type="text/javascript">
//============================================================
// ACCESS RAW DATA FROM MIC 

// https://developers.google.com/web/fundamentals/native-hardware/recording-audio/#access_the_raw_data_from_the_microphone

  var handleSuccess = function(stream) {
    var context = new AudioContext();
    var input = context.createMediaStreamSource(stream)
    var processor = context.createScriptProcessor(1024,1,1);

    source.connect(processor);
    processor.connect(context.destination);

    processor.onaudioprocess = function(e){
			console.log('audio data outputing...')
      // Do something with the data, i.e Convert this to WAV
      console.log(e.inputBuffer);
    };
  };

//============================================================
// https://developers.google.com/web/fundamentals/native-hardware/recording-audio/#use_the_permissions_api_to_check_if_you_already_have_access

// Check/Ask for access to microphone
navigator.permissions.query({name:'microphone'}).then(function(result) {
  if (result.state == 'granted') {
		// Audio access approved!
		navigator.mediaDevices.getUserMedia({ audio: true, video: false })
				.then(handleSuccess)

  } else if (result.state == 'prompt') {
		//==========================================
		// Should prompt user for permission here //
		//==========================================
  } else if (result.state == 'denied') {
		//=================================
		// Should handle rejection here. //
		//=================================
  }
  result.onchange = function() {

  };
});

//============================================================


</script>